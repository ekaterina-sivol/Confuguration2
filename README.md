# Сиволгина Екатерина. ИКБО-21-24. Вариант №24
Разработан инструмент визуализации графа зависимостей для менеджера
пакетов. Готовые средства (менеджеры пакетов, библиотеки) для получения
зависимостей использовать нельзя.
### Этап 1.Минимальный прототип с конфигурацией
### Общее описание.
#### Цель: создано и настроено минимальное CLI-приложение.
#### Требования:
1. Источником настраиваемых пользователем параметров является
конфигурационный файл формата INI.
2. К настраиваемым параметрам относятся:
– Имя анализируемого пакета.
– URL-адрес репозитория или путь к файлу тестового репозитория.
– Режим работы с тестовым репозиторием.
– Версия пакета.
– Имя сгенерированного файла с изображением графа.
– Режим вывода зависимостей в формате ASCII-дерева.
– Подстрока для фильтрации пакетов.
3. (только для этого этапа) При запуске приложения выводит все параметры,
настраиваемые пользователем, в формате ключ-значение.
4. Реализовано и продемонстрировано обработка ошибок для всех параметров.
5. Результат выполнения этапа сохранен в репозиторий стандартно
оформленным коммитом.
### Описание всех функций и настроек
#### Функции:
* print_config_summary(config) - выводит все параметры конфигурации в формате ключ-значение. Параметры: config (dict) - словарь с параметрами конфигурации.
* parse_arguments() - парсит аргументы командной строки, возвращает объект с аргументами.
* test_config_files() - тестирует различные конфигурационные файлы.
* main() - основная функция приложения, точка входа.
#### Настройки конфигурационного файла:
##### Обязательные параметры:
* name (str) - имя пакета в формате groupId:artifactId.
* version (str) - версия пакета для анализа.
* repository_url (str) - URL-адрес Maven-репозитория для загрузки POM-файлов
##### Опциональные параметры:
* test_repository_mode (bool) - режим тестирования с использованием локальных файлов вместо удаленного репозитория. По умолчанию: false
* test_repository_path (str) - путь к тестовому репозиторию. По умолчанию: "./test_repo"
* output_filename (str) - имя файла для сохранения графа зависимостей. По умолчанию: "dependency_graph.png"
* ascii_tree_mode (bool) - режим вывода зависимостей в формате ASCII-дерева. По умолчанию: false
* package_filter (str) - строка для фильтрации пакетов. По умолчанию: "" (без фильтрации)
### Описание команд для сборки проекта и запуска тестов
Программа требует только стандартные библиотеки Python: configparser, sys, os, argparse, pathlib. Тестирование проводится путем запуска приложения с различными конфигурационными файлами. Для тестирования используются заранее подготовленные конфигурационные файлы с разными настройками.
### Тестирование
Результат работы программы с корректным файлом и параметрами
<img width="751" height="298" alt="image" src="https://github.com/user-attachments/assets/e6ed6fde-23ed-4a85-8fa7-bc4e6f24b8b0" />
Результат работы программы с ошибкой в имени пакета (отсутствие имени пакета)
<img width="1446" height="68" alt="image" src="https://github.com/user-attachments/assets/ca9a6dc9-9361-4cdd-8143-b9e533aec544" />
Результат работы программы с ошибкой в URL (отсутствие URL-адреса)
<img width="1436" height="49" alt="image" src="https://github.com/user-attachments/assets/039a1263-0a56-49f6-b361-f4b275ef973b" />
Результат работы программы с ошибкой в режиме работы с тестовым репозиторием (недопустимый режим работы)
<img width="1440" height="73" alt="image" src="https://github.com/user-attachments/assets/ff15daee-08f0-4c2d-8c9d-ad3ea1d5831e" />
Результат работы программы с ошибкой в версии пакета (некорректный формат версии)
<img width="1272" height="52" alt="image" src="https://github.com/user-attachments/assets/2f121925-bd2a-4611-a79a-1e882444b079" />
Результат работы программы с ошибкой в имени сгенерированного файла с изображением графа
<img width="1272" height="45" alt="image" src="https://github.com/user-attachments/assets/ee53d25f-6909-42ff-8e7e-9db9f932a68d" />
Результат работы программы с ошибкой в режиме вывода зависимостей в формате ASCII-дерева (недопустимое значение)
<img width="1451" height="67" alt="image" src="https://github.com/user-attachments/assets/4a6ebfeb-8db9-4150-a65d-ccefa7cf87af" />
Результат работы программы с ошибкой в подстроке для фильтрации пакетов
<img width="1025" height="47" alt="image" src="https://github.com/user-attachments/assets/863111f2-dff4-4fdb-8cf3-bfa75546fe84" />
### Этап 2. Сбор данных
### Общее описание.
#### Цель: реализовано основная логика получения данных о зависимостях для их
дальнейшего анализа и визуализации. Запрещено пользоваться менеджерами
пакетов и сторонними библиотеками для получения информации о зависимостях
пакетов.
#### Требования:
1. Использован формат пакетов Java (Maven).
2. Информацию необходимо получить для заданной пользователем версии
пакета.
3. Извлечена информация о прямых зависимостях заданного пользователем
пакета, используя URL-адрес репозитория.
4. (только для этого этапа) Выведено на экран все прямые зависимости
заданного пользователем пакета.
5. Результат выполнения этапа сохранен в репозиторий стандартно
оформленным коммитом.
### Описание всех функций и настроек
#### Функции:
*parse_package_name(package_name) - парсит имя пакета на составляющие groupId и artifactId.
Параметры: package_name (str) - имя пакета в формате groupId:artifactId.Возвращает: tuple[str, str] - groupId и artifactId.
*build_pom_url(group_id, artifact_id, version) - строит URL для POM-файла по Maven-конвенции.
Параметры: group_id (str), artifact_id (str), version (str).Возвращает: str - URL POM-файла.
*get_dependencies(package_name, version) - скачивает POM-файл и получает прямые зависимости Maven-пакета.Параметры: package_name (str) - имя пакета, version (str) - версия пакета.
Возвращает: List[Dict[str, str]] - список зависимостей пакета.
*print_config_summary(config) - выводит сводку конфигурации в читаемом формате.
Параметры: config (dict) - словарь с параметрами конфигурации.
*parse_arguments() - парсит аргументы командной строки.
Возвращает: argparse.Namespace - объект с аргументами.
#### Настройки конфигурационного файла:
##### Обязательные параметры:
*name (str) - имя пакета в формате groupId:artifactId
*version (str) - версия пакета
*repository_url (str) - URL Maven-репозитория
##### Опциональные параметры:
*test_repository_mode (bool) - режим тестового репозитория (по умолчанию: False)
*test_repository_path (str) - путь к тестовому репозиторию (по умолчанию: ./test_repo)
*output_filename (str) - имя выходного файла графа (по умолчанию: dependency_graph.png)
*ascii_tree_mode (bool) - режим вывода в формате ASCII-дерева (по умолчанию: False)
*package_filter (str) - фильтр пакетов (по умолчанию: пусто)
### Описание команд для сборки проекта и запуска тестов
Программа требует только стандартные библиотеки Python: configparser, sys, os, argparse, pathlib, typing, urllib.request, urllib.error, xml.etree.ElementTree. Тестирование проводится путем запуска приложения с передачей конфигурационного INI-файла в качестве аргумента командной строки.
Результат работы программы с корректными прямыми зависимостями в файле
<img width="1327" height="499" alt="image" src="https://github.com/user-attachments/assets/2dee0f79-c767-4d9b-a1b1-e754e7e50a56" />

### Этап 3. Основные операции
### Общее описание.
#### Цель: построен граф зависимостей (с учетом транзитивности) и выполнены
основные операции над ним.
#### Требования:
1. Получен граф зависимостей реализовать алгоритмом DFS с рекурсией.
2. Не учтены при анализе пакеты, имя которых содержит заданную
пользователем подстроку.
3. Корректно обработаны случаи наличия циклических зависимостей.
4. Поддержан режим тестирования. Вместо URL реального репозитория, дали
возможность пользователю указать путь к файлу описания графа
репозитория, где пакеты называются большими латинскими буквами.
Продемонстрирована функциональность этого этапа на различных случаях
работы с тестовым репозиторием.
5. Результат выполнения этапа сохранен в репозиторий стандартно
оформленным коммитом
### Описание всех функций и настроек
#### Функции:
*parse_config(config_path) - парсит конфигурационный INI файл и возвращает параметры с валидацией.Параметры: config_path (str) - путь к INI файлу конфигурации.Возвращает: dict - словарь с параметрами конфигурации.
*get_dependencies_from_pom(package_name, version, repository_url) - скачивает и парсит POM-файл из Maven-репозитория.Параметры: package_name (str) - имя пакета, version (str) - версия пакета, repository_url (str) - URL репозитория Maven.Возвращает: list - список зависимостей пакета.
*_parse_package_name(package_name) - парсит имя пакета на groupId и artifactId.Параметры: package_name (str) - имя пакета в формате "groupId:artifactId".Возвращает: tuple - (group_id, artifact_id).
*_build_pom_url(group_id, artifact_id, version, repository_url) - строит URL для POM-файла по Maven-конвенции.Параметры: group_id (str), artifact_id (str), version (str), repository_url (str).Возвращает: str - URL POM-файла.
*_parse_dependencies_from_pom(pom_content) - парсит зависимости из содержимого POM-файла.Параметры: pom_content (str) - содержимое POM-файла.Возвращает: list - список зависимостей.
*read_dependencies_from_test_file(package_name, test_repo_path) - читает зависимости пакета из тестового файла.Параметры: package_name (str) - имя пакета, test_repo_path (str) - путь к тестовому файлу.Возвращает: list - список зависимостей.
*get_package_dependencies(package_name, version, repository_url, is_test_mode) - универсальная функция для получения зависимостей пакета.Параметры: package_name (str) - имя пакета, version (str) - версия пакета, repository_url (str) - URL репозитория или путь к файлу, is_test_mode (bool) - флаг тестового режима.Возвращает: list - список зависимостей.
*_should_filter_package(package_name, package_filter) - проверяет, нужно ли фильтровать пакет.
Параметры: package_name (str) - имя пакета, package_filter (str) - фильтр.Возвращает: bool - True если пакет должен быть отфильтрован.
*build_dependency_graph(package_name, version, repository_url, is_test_mode, package_filter="", depth=0, max_depth=10) - рекурсивно строит граф зависимостей для пакета с использованием DFS.
Параметры: package_name (str) - имя пакета, version (str) - версия пакета, repository_url (str) - URL репозитория, is_test_mode (bool) - флаг тестового режима, package_filter (str) - фильтр пакетов, depth (int) - текущая глубина рекурсии, max_depth (int) - максимальная глубина рекурсии.
*_process_cycles() - обрабатывает циклические зависимости для специального отображения.
*display_ascii_tree(start_package, prefix="", is_last=True) - отображает граф в виде ASCII-дерева.Параметры: start_package (str) - корневой пакет, prefix (str) - префикс для отступов, is_last (bool) - является ли последним элементом.
*display_dependency_graph(ascii_mode=False) - выводит построенный граф зависимостей в консоль.
Параметры: ascii_mode (bool) - режим вывода в формате ASCII-дерева.
*create_test_files() - создает тестовые файлы для демонстрации работы программы.
*get_all_packages_from_test_file(test_repo_path) - получает список всех пакетов из тестового файла.Параметры: test_repo_path (str) - путь к тестовому файлу.Возвращает: list - список пакетов.
*build_complete_dependency_graph(repository_url, is_test_mode) - строит полный граф всех пакетов в репозитории.Параметры: repository_url (str) - URL репозитория или путь к файлу, is_test_mode (bool) - флаг тестового режима.
*get_start_package_from_config() - получает стартовый пакет из конфигурации.Возвращает: str - имя пакета.
*interactive_test_mode() - запускает интерактивный режим тестирования.
#### Настройки конфигурационного файла:
##### Обязательные параметры:
*name (str) - название анализируемого пакета в формате "groupId:artifactId".
*version (str) - версия пакета для анализа.
*repository_url (str) - URL-адрес Maven-репозитория.
##### Опциональные параметры:
*test_repository_mode (bool) - режим работы с тестовым репозиторием. По умолчанию: False.
*test_repository_path (str) - путь к тестовому файлу. По умолчанию: "./test_repo".
*package_filter (str) - фильтр пакетов для исключения из анализа. По умолчанию: "".
*ascii_tree_mode (bool) - режим вывода зависимостей в формате ASCII-дерева. По умолчанию: False.
*output_filename (str) - имя файла для сохранения графа. По умолчанию: "dependency_graph.png".
#### Глобальные переменные:
*graph (dict) - хранит граф зависимостей: пакет → список зависимостей.
*visited (set) - отслеживает полностью обработанные пакеты.
*visiting (list) - отслеживает пакеты в текущем пути обхода (для обнаружения циклов).
*cycles (dict) - хранит информацию об обнаруженных циклических зависимостях.
*original_dependencies (dict) - сохраняет оригинальные зависимости до обработки циклов.
### Описание команд для сборки проекта и запуска тестов
Программа требует только стандартные библиотеки Python: configparser, os, sys, urllib.request, urllib.error, xml.etree.ElementTree. Тестирование может проводиться как в интерактивном режиме (пользователь указывает путь к файлу описания графа репозитория), так и путем запуска с конфигурационным INI-файлом.
### Тестирование
Результат работы программы с линейной структурой графа зависимости
<img width="904" height="597" alt="image" src="https://github.com/user-attachments/assets/d709cb0e-787f-420f-a348-b84b03ba0979" />
Результат работы программы со сложной структурой графа зависимости
<img width="920" height="730" alt="image" src="https://github.com/user-attachments/assets/bb49f261-2745-4a83-83f7-f0c94b7b2fa8" />
Результат работы программы с алмазной структурой графа зависимости
<img width="917" height="579" alt="image" src="https://github.com/user-attachments/assets/e8259c3e-1b90-4238-abe0-5e0ff046ac3f" />
Результат работы программы с циклической структурой графа зависимости
<img width="916" height="574" alt="image" src="https://github.com/user-attachments/assets/7a6d7df5-4365-445a-9d78-56552b8ccfa0" />
